hp_freq = {
    " ": 0.1744,
    "e": 0.0983,
    "t": 0.0715,
    "a": 0.0655,
    "o": 0.0644,
    "h": 0.0555,
    "n": 0.0537,
    "r": 0.0533,
    "i": 0.0512,
    "s": 0.0485,
    "d": 0.0409,
    "l": 0.0359,
    "u": 0.024,
    "y": 0.0212,
    "g": 0.0212,
    "w": 0.0206,
    "m": 0.0182,
    "f": 0.0168,
    "c": 0.0165,
    "p": 0.0136,
    "b": 0.0131,
    "k": 0.0098,
    "v": 0.0071,
    "q": 0.001,
    "x": 0.0009,
    "j": 0.0009,
    "z": 0.0006,
}
ct = [
    bytearray(
        b"\xa5\xfd\xab\x8c$\x96\xf3\x9c\r\xa4O\xc9&G\x01!\x89h\xc4\x1e\xfa\x86Y\xac{-\x8b\xda\xda\xfc\xbc\x86S\xf9\xef\x03\x8f\x8b\xd7\xed\x91\xad\x00\xc8&\xa8\x90\xe0\xe6+\xf54h"
    ),
    bytearray(
        b"\xaf\xaf\xbc\x8c\x1f\xd7\xe4\x98\x04\xe1M\xf9e\nD/\x89o\x8d\x0c\xae\x9bK\xefq-\x93\xcf\xc0\xf7\xa7\x9b\x14\xbc\xa1Z\x9d\xdb\xdc\xfc\x80\xf4E\x95&\x8d\x8b\xfb\xeb`\xbf4T"
    ),
    bytearray(
        b"\xae\xaf\xb2\x8c2\x98\xe9\xde\x1d\xa4\x0f\xfe$\x08I}\x9ci\xc9M\xb3\x81\n\xf8rh\xdc\xdf\xc9\xe0\xbe\xc4\x14\xbc\xa1Z\x8f\x8b\xc5\xe9\x97\xb2E\x95&\x90\x90\xfd\xa2j\xfag["
    ),
    bytearray(
        b"\xb5\xbb\xe6\xd8$\x92\xea\x9b\x05\xe1M\xf7m\x02J/\x9c \xcc\x01\xb9\x80B\xe3vd\x9f\x97\x88\xff\xa0\x9bW\xb9\xaa\t\xce\xdf\xdc\xef\x8d\xad\x00\xd4&\xab\x8f\xa9\xad+\x8d|Y"
    ),
    bytearray(
        b"\xbf\xaf\xa2\xc83\x99\xeb\x80I\xfd\x02\xee$\x0fJj\x91 \xc1\x04\xb1\x8a\n\xf5ux\x8e\x9b\xc1\xfc\xf5\x89\x14\xbd\xa0\x08\x9c\xc4\xc7\xa8\x83\xb5\x0c\xd9m\xfe\xd0\xa9\xdbd\xaf4_"
    ),
    bytearray(
        b"\xa1\xaf\xb5\xc55\xd0\xf4\xd9\x1d\xec\x08\xbbg\x05Zj\xd1 \xda\x05\xbf\x81\n\xc5:n\x93\xd6\xcd\xb2\xac\x87A\xa7\xef\r\x8f\xd9\xdb\xed\x81\xf9J\x9aG\xae\x90\xea\xe3g\xa3dK"
    ),
    bytearray(
        b"\xa4\xbb\xb0\xc98\xd0\xf3\xd9\x10\xeb\x18\xbba\x1fJ}\xddh\xc8\x0c\xa8\x8b\n\xe3|-\x9d\x9b\xe5\xd1\xf8\x85A\xa7\xab\x1f\x9c\xce\xc7\xb7\xc5\xf6E\xeen\xb7\x8c\xa9\xebx\xfa`P"
    ),
    bytearray(
        b"\xa8\xbf\xa7\xd8>\xd7\xf0\x90\x1a\xecA\xbbw\x06\x0fl\x92m\xc8M\xb5\x81\x06\xaciy\x99\xcb\x88\xe6\xba\xc8@\xbd\xa6\t\xce\x84\x95\xc0\x9c\xaa\x11\xdft\xb7\x9c\xe8\xee+\xb3p]"
    ),
    bytearray(
        b"\xaa\xa8\xaf\xc87\x8e\xa7\x8d\x01\xe1M\xefl\x00]{\x98e\xc3\x19\xb2\xc3\n\xfb{a\x97\xd2\xc6\xf5\xf5\x8c[\xa2\xa1Z\xab\xc7\xd8\xa8\xb6\xad\x17\xdfc\xaa\xdf\xa6\xa2R\xb5a\x18"
    ),
    bytearray(
        b"\xb8\xb2\xaf\xdfv\x9e\xf4\xd9\x06\xe2\x0b\xbbh\x00Bf\x89s\x81M\xa9\x80\n\xf5ux\x8e\x9b\xde\xfb\xa6\x81[\xbb\xbcZ\x8f\xd9\xd0\xa8\x87\xb5\x10\xc8t\xa7\xdf\xa6\xa2J\xb6x\x18"
    ),
    bytearray(
        b"\xb8\xbf\xb4\xde9\x85\xa7\x90\x07\xa4\x19\xf3aI\\{\x84l\xc8\x1e\xf6\xcfD\xe9lh\x8e\x9b\xcd\xe0\xa7\x87F\xf8\xa9\x13\x82\xce\xc6\xa8\xca\xf9,\xd4b\xbb\x9a\xed\xa2B\xfdy\x18"
    ),
    bytearray(
        b'\xaa\xb5\xb4\x8c"\x9f\xe8\x8a\x0c\xa4\x19\xf3e\x1d\x0f`\x8dp\xc2\x1e\xbf\xcf^\xe3:o\x99\x9b\xc4\xf7\xa3\x8dX\xf5\xa0\x08\xce\xc5\xd0\xf0\x91\xf9\x11\xd5&\xaa\x97\xe0\xf1+\xf54q'
    ),
    bytearray(
        b"\xbb\xb5\xb4\xdf3\xd7\xf3\x91\x08\xeaM\xfa$\x07Fh\x95t\xc0\x0c\xa8\x8a\x06\xaccb\x89\x9b\xcc\xfd\xbb\xcf@\xf5\xa7\x1b\x98\xce\x95\xfc\x8a\xf9\x16\xd6c\xbb\x8f\xa9\xe3+\xad}V"
    ),
    bytearray(
        b"\xaa\xb6\xa7\xdf>\x95\xe6\x9a\x02\xf7M\xf2j\x1dJ}\x9be\xdf\x08\xf6\xcfS\xed:~\x88\xda\xda\xe6\xf5\x9c[\xf5\xa7\x1f\x8f\xd9\x8f\xa8\xca\xf91\xd2c\xfe\xad\xa4\xc3&\x919q"
    ),
    bytearray(
        b"\xb8\xb2\xa3\xc2v\x83\xef\x9cI\xe6\x08\xfapIF|\xddh\xd4\x1e\xae\x8aX\xe5yl\x90\x9b\x87\xb2\x81\x80U\xa1\xef\x17\x8f\xc0\xd0\xfb\xc5\x9c\x17\xd3e\xfe\x98\xe6\xa2l\xbf`\x18"
    ),
    bytearray(
        b"\xbf\xb5\xa9\xc2v\x83\xef\x9cI\xe8\x14\xe9m\nNc\xddf\xc2\x1f\xb7\x8e^\xacs~\xdc\xc8\xdd\xe2\xb0\x9a]\xba\xbdZ\xc1\x8b\xf3\xe9\x86\xbc\x16\x9ai\xb8\xdf\xed\xe7j\xae|\x18"
    ),
    bytearray(
        b"\xa1\x99\xe1\xdfv\x93\xe2\x9a\x08\xfd\x04\xf5cE\x0fl\x88z\x8d\x19\xb2\x8aS\xacth\x8a\xde\xda\xb2\xa6\x9cU\xac\xaa\x1e\xce\x84\x95\xdc\x8d\xbcE\xc9e\xbb\x91\xec\xa2d\xbc4Y"
    ),
    bytearray(
        b"\xb8\xb2\xa3\x8c0\x9e\xe2\x97\r\xa4\x02\xfd$\x08\x0f}\x95y\xc0\x08\xfa\x80D\xacne\x99\x9b\xc5\xfb\xb6\xc8@\xbd\xae\x0e\xce\xd2\xda\xfd\xc5\xb2\x0b\xd5q\xfe\xd0\xa9\xcb\x7f\xfdg\x18"
    ),
    bytearray(
        b"\xa1\xbf\xaa\xc32\x9e\xe2\x8aD\xf1\x03\xf6e\x02Nm\x91e\x81M\xaa\x8e^\xf8\x7f\x7f\x92\x96\xdd\xfc\xb0\x9bW\xb4\xbf\x1b\x8c\xc7\xd0\xa8\xca\xf9$\x9an\xb1\x8d\xe7\xa2b\xbc4O"
    ),
    bytearray(
        b"\xa5\xfa\xa4\xc03\x84\xf4\xd9\x1d\xec\x08\xbbg\x01Fc\x99,\x8d\x19\xb2\x8a\n\xe9{\x7f\x88\xd3\x84\xb2\xa1\x80Q\xf5\xa8\x15\x8a\xd8\x95\xe9\x8b\xbdE\xd8i\xb3\x9d\xa9\xf6c\xbf4J"
    ),
    bytearray(
        b"\xa4\xbb\xbc\xcd$\x93\xe8\x8c\x1a\xa4\x19\xf4$\x10@z\x8f \xc5\x08\xbb\x83^\xe4:~\x93\x9b\xca\xf7\xf5\x8eF\xbc\xaa\x14\x8a\xc7\xcc\xa8\xca\xf9$\x9ak\xbf\x8b\xfd\xe7y\xfa{^"
    ),
    bytearray(
        b"\xbf\xb2\xa7\xc73\xd7\xa0\x8d\x00\xe8\x01\xbb}\x06Z}\xddc\xc1\x08\xbb\x9d\x06\xacwl\x97\xde\x88\xfb\xa1\xc8P\xbc\xbc\x1b\x9e\xdb\xd0\xe9\x97\xf5E\xd7g\xb5\x9a\xa9\xf6c\xbf4V"
    ),
    bytearray(
        b"\xa5\xbc\xe6\xc29\x83\xab\xd9\x04\xfdM\xe8k\x1cC(\x91l\x8d\x1f\xbf\x83O\xedih\xdd\x9b\x87\xb2\x81\x80Q\xf5\xbc\x19\x8b\xc5\xd0\xa8\x8c\xaaE\xc8c\xbd\x8d\xec\xe3\x7f\xbfp\x14"
    ),
    bytearray(
        b"\xaf\xaf\xbc\x8c/\x98\xf2\x8bI\xe5\x0f\xf4q\x1d\x0f{\x92 \xde\x08\xbf\xcfK\xac~d\x8f\xda\xdb\xe6\xa7\x87A\xa6\xef\t\x87\xcc\xdd\xfc\xc5\xf6E\xfb&\xae\x9a\xfb\xe4d\xa8yY"
    ),
    bytearray(
        b"\xa0\xa3\xb4\xc55\x84\xa7\x96\x0f\xa4\x0b\xeev\x10\x0e/\xbc \xcb\x08\xbb\x9dC\xeash\x98\x9b\xce\xe0\xb0\x8dG\xa1\xb6\x16\x8b\x8a\x95\xa7\xc5\x8d\r\xdf&\xfc\xad\xab\xa2b\xa94Q"
    ),
    bytearray(
        b"\xa1\xbb\xad\xc9v\x84\xf2\x8b\x0c\xa4\x19\xf3aI\\v\x8et\xc8\x00\xfd\x9c\n\xe0ux\x98\x9b\xdf\xfa\xb0\x86\x14\x9c\xef\x17\x8b\xc5\xc1\xe1\x8a\xb7E\x95&\x8e\x97\xfb\xe3x\xbfg\x18"
    ),
    bytearray(
        b"\xb5\xb5\xb3\x8c!\x96\xe9\x8dI\xf0\x02\xbbl\x0cN}\xdds\xc2\x00\xbf\xcfY\xe3oc\x98\xc8\x88\xe6\xbd\x89@\xf5\xa1\x15\x9a\x8b\xda\xe6\x89\xa0E\xcai\xab\x91\xed\xf1+\xb8aL"
    ),
    bytearray(
        b"\xb8\xb2\xa3\xc2v\x99\xe8\x97\n\xec\x0c\xf7e\x07[c\x84 \xd9\x08\xb6\x83\n\xf5ux\xdc\xcc\xc0\xf3\xa1\xc8]\xa1\xef\x17\x8b\xca\xdb\xa8\x91\xb6E\xd7c\xfe\xd0\xa9\xd1\x7f\xa8}["
    ),
    bytearray(
        b"\xad\xb4\xa2\x8c\x1f\xd7\xe3\x96\x07\xa3\x19\xbbg\x08]j\xddi\xcbM\xae\x87O\xacme\x93\xd7\xcd\xb2\xb6\x9a[\xa2\xab]\x9d\x8b\xd4\xa8\x92\xb0\x11\xd4c\xad\x8c\xa8\xa2$\xfa]\x1f"
    ),
    bytearray(
        b"\xbc\xa8\xa9\xcb$\x96\xea\xd9\x00\xea\x19\xf4$\x1dGj\xdds\xdd\x08\xbf\x8b\n\xe3|-\x88\xd3\xcd\xb2\xa7\x80M\xb8\xaaV\xce\xdb\xc7\xed\x95\xb8\x17\xdf&\xaa\x90\xa9\xf1\x7f\xbbfL"
    ),
    bytearray(
        b"\xa1\xaf\xb5\xc55\x96\xeb\xd9\x04\xe5\t\xf5a\x1a\\/\xb0C\x8d\x08\xac\x8aX\xacwl\x98\xde\x84\xb2\xa6\x8dQ\xf5\xa6\x0e\xc9\xd8\x95\xa7\xc5\x97\n\xcd&\xbf\x91\xa9\xe7f\xbff_"
    ),
    bytearray(
        b"\xa3\xaa\xa3\xc2v\x8e\xe8\x8c\x1b\xa4\x00\xf2j\r\x03/\x84o\xd8M\xad\x86F\xe0:k\x95\xd5\xcc\xb2\xb0\x9eQ\xa7\xb6Z\x99\xc4\xc7\xec\xc2\xb5\t\x9ad\xbb\xdf\xa6\xa2M\xaffQ"
    ),
    bytearray(
        b"\xae\xbb\xb2\xd8:\x92\xa0\x8aI\xf0\x08\xf6t\x1dFa\x9a.\x83C\xad\x87K\xf8\x7f{\x99\xc9\x88\xe1\xa0\x81@\xa6\xef\x03\x8f\x8a\x95\xa7\xc5\x9f\n\xc8&\xa9\x90\xfb\xe6x\xfa`P"
    ),
    bytearray(
        b'\xb5\xb5\xb3\x8c"\x9f\xee\x97\x02\xa4\x14\xf4qN]j\xddr\xd8\x0b\xbc\x8aX\xa0:y\x94\xde\xc6\xb2\xa6\x9dR\xb3\xaa\x08\xce\xdf\xdd\xed\xc5\xba\n\xd4u\xbb\x8e\xfc\xe7e\xb9qK'
    ),
    bytearray(
        b"\xa5\xfa\xb1\xcd=\x92\xa7\x80\x08\xa4\x1a\xf2p\x01\x0fg\x88n\xc9\x1f\xbf\x8bY\xacuk\xdc\xcf\xc0\xfd\xa0\x9bU\xbb\xab\t\xce\xc4\xd3\xa8\x93\xb6\t\xceu\xfe\xd0\xa9\xcfb\xb99L"
    ),
    bytearray(
        b"\xa2\xb5\xb0\xc35\x96\xee\x97I\xe1\x0c\xe8aI[g\x98 \xdd\x0c\xb3\x81\n\xe5n-\x91\xd2\xcf\xfa\xa1\xc8G\xb4\xb9\x1f\xce\xc3\xdc\xe5\xc5\xf6E\xf3`\xfe\x91\xe6\xf6'\xfaQJ"
    ),
    bytearray(
        b"\xb5\xb5\xe6\xfe7\x9c\xee\x94E\xa4\x1a\xf3e\x1d\x08|\xddu\xddR\xfa\xc0\n\xd5u!\xdc\xf2\x8f\xff\xf5\x8c[\xbc\xa1\x1d\xce\xdf\xdd\xed\xc5\xb2\x0b\xd5q\xb2\x9a\xed\xe5n\xf64}"
    ),
    bytearray(
        b"\xbb\xbf\xaa\xc0z\xd7\xe4\x91\x0c\xe7\x06\xbbp\x01F|\xddo\xd8\x19\xf6\xcfY\xe5tn\x99\x9b\xe6\xfd\xa7\x8aM\xf5\x98\x1b\x82\xdf\xd0\xfa\x96\xf9\x0c\xc9&\xb1\x8a\xfb\xa2j\xbdqV"
    ),
    bytearray(
        b"\xa7\xbb\xb4\xcdv\xbb\xe2\x8e\x00\xf7M\xf2wI@z\x8f \xcc\n\xbf\x81^\xa0:z\x93\xc9\xcc\xb2\xa0\x98\x14\xfa\xef \x8f\xc0\xdc\xe9\xc5\xb8\x0b\xde&\xea\x8b\xe1\xa2j\xb4p\x18"
    ),
    bytearray(
        b"\xa3\xb1\xa7\xd5z\xd7\xf4\x96I\xf3\x05\xf4$\x1eJ/\x8fo\xc1\x01\xb3\x81\r\xacmd\x88\xd3\x88\xe6\xbd\x8dZ\xea\xef-\x8b\x8b\xc7\xe7\x89\xb5\x0c\xd4!\xfe\x88\xe0\xf6c\xfaFM"
    ),
    bytearray(
        b"\xaf\xb2\xa3\xcf=\xd7\xf3\x91\x00\xf7M\xf4q\x1d\x03/\x8ei\xc3\x0e\xbf\xcf]\xe9:y\x9d\xd7\xc3\xfb\xbb\x8f\x14\xba\xb9\x1f\x9c\x8b\x9a\xa8\xb1\xb1\x0c\xc9&\xba\x9a\xef\xa2i\xbfuL"
    ),
    bytearray(
        b"\xa5\xfa\xb1\xcd8\x99\xe6\xd9\x01\xe1\x0c\xe9$\x1a@b\x98 \xc2\x0b\xfa\x9bB\xe9w-\x98\xde\xce\xb2\xa7\x80M\xb8\xaa\t\xc2\x8b\xcc\xe7\x90\xf9\x0e\xd4i\xa9\xdf\xfe\xeaj\xae4q"
    ),
    bytearray(
        b"\xb8\xb2\xaf\xc2=\x9e\xe9\xdeI\xeb\x0b\xbbeIBn\x8et\xc8\x1f\xfa\x9fF\xedt-\xd3\x9b\x8f\xd1\xa0\x92\x14\xb4\xa6\x14\xc9\xdf\x95\xe6\x90\xad\r\xd3h\xf9\xdf\xeb\xf7\x7f\xfagO"
    ),
    bytearray(
        b"\xbf\xb5\xe6\xe5v\x93\xee\x9eI\xed\x03\xefkIBv\xddp\xc2\x0e\xb1\x8a^\xa0:l\x90\xd7\x88\xff\xac\xc8Y\xba\xa1\x1f\x97\x8b\xdc\xfb\xc5\xaa\x15\xdfh\xaa\xdf\xa6\xa2X\xb54q"
    ),
    bytearray(
        b"\xbf\xb5\xe6\xe5v\x84\xf3\x98\x1b\xf0M\xf6}IBf\x8es\xc4\x02\xb4\xc3\n\xe0\x7fl\x8a\xde\x88\xff\xac\xc8F\xb0\xbc\x13\x8a\xce\xdb\xeb\x80\xf9J\x9aR\xb6\x96\xe7\xe9b\xb43\x18"
    ),
    bytearray(
        b"\xa5\xfa\xa8\xc93\x93\xa7\x94\x06\xea\x08\xe2(If/\x88s\xc8\t\xfa\x9bE\xacxh\xdc\xda\x88\xe1\xa1\x81W\xbe\xe2\x0f\x9e\x8b\xde\xe1\x81\xf9J\x9aU\xb1\xdf\xc0\xa2\x7f\xb2}V"
    ),
    bytearray(
        b"\xa5\xfa\xb3\xdf3\x93\xa7\x8d\x06\xa4\x1f\xf4h\x05\x0fz\x8d,\x8d\x19\xb2\x86Y\xacs~\xdc\xda\x88\xfa\xba\x84P\xf5\xba\n\xc2\x8b\xd4\xe1\x8b\xfe\x11\x9ah\xab\x8b\xe1\xebe\xfd4^"
    ),
    bytearray(
        b"\xae\xaf\xb2\x8c8\x98\xf0\xd9 \xa4\x01\xfee\x1bAj\x99 \xd9\x02\xfa\x8aK\xfet-\xdb\xd8\xdd\xe8\xf5\xa1\x13\xb8\xef\x08\x87\xcc\xdd\xfc\x80\xb6\x10\xc9&\xf1\xdf\xc0\xa2m\xbfqT"
    ),
    bytearray(
        b"\xbf\xbf\xa7\xde5\x9f\xa7\x9f\x06\xf6M\xfa$\x07Fa\x98 \xd9\x02\xfa\x89C\xfa\x7f!\xdc\xd2\xce\xb2\x9c\xc8G\xa1\xbd\x13\x98\xce\x95\xa7\xc5\x8d\r\xdfh\xfe\x92\xe8\xfbi\xbf4q"
    ),
    bytearray(
        b"\xbf\xb5\xe6\xe5v\x80\xe6\x95\x02\xa4\x18\xeb$\x1dGj\xdds\xd9\x1f\xbf\x8a^\xacme\x95\xc8\xdc\xfe\xbc\x86\x13\xf5\xbb\x12\x87\xd8\x95\xa7\xc5\x9f\x00\xdfj\xb7\x91\xae\xa2d\xaf`\x18"
    ),
    bytearray(
        b"\xad\xfa\xb6\xc98\xd7\xe6\x97\r\xa4\x0c\xbbt\x08_j\x8f,\x8d\x0c\xfa\x9c^\xe9hh\x93\x97\x88\xf3\xf5\x9cU\xa5\xaaZ\x81\xcd\x95\xa7\xc5\x94\x00\x9ag\xb0\x9b\xa9\xc7y\xb3w\x18"
    ),
    bytearray(
        b"\xaa\xb3\xb5\xc4z\xd7\xf0\x91\x00\xe7\x05\xbbm\x1a\x0fb\x84 \xcb\x0c\xac\x80X\xe5nh\xdc\xdf\xc1\xe1\xbd\xc8\x1b\xf5\x8d\x0f\x9a\x8b\xc2\xe1\x91\xb1\n\xcfr\xfe\x91\xe6\xa2f\xb5z]"
    ),
    bytearray(
        b"\xcb\x99\xb3\xd6v\xbe\xa7\x9d\x06\xeaJ\xef$\x05Fd\x98 \xd9\x02\xfa\x8bX\xe9{`\xdc\xda\xca\xfd\xa0\x9c\x14\xb2\xaa\x0e\x9a\xc2\xdb\xaf\xc5\xa9\x04\xd3b\xfe\xd0\xa9\xd1d\xfa]\x18"
    ),
    bytearray(
        b"\xbf\xb5\xe6\xc29\x80\xa7\x8d\x06\xa4\x19\xfew\x1d\x0f{\x92 \xde\x08\xbf\xcfC\xea:D\xdc\xdc\xc7\xe6\xf5\x98A\xb9\xa3Z\xc1\x8b\xfd\xe1\x91\xf9\x11\xd2c\xfe\x8c\xfd\xf7o\xb3{\x14"
    ),
    bytearray(
        b"\xbe\xbb\xad\xc5;\xdb\xa7\x9a\x01\xe1\x0e\xf0$\x1dGf\x8e \xc2\x18\xae\xc3\n\xf5u-\xd3\x9b\xf1\xfd\xa0\xc8S\xba\xef\x0e\x81\x8b\xcc\xe7\x90\xabE\xddo\xac\x93\xa9\xead\xafg]"
    ),
    bytearray(
        b"\xcb\x99\xa7\xd9%\x92\xa7\x94\x10\xa4\n\xf2v\x05\x0ff\x8e \xc9\x08\xbc\x86D\xe5nh\x90\xc2\x88\xff\xb4\x8c\x14\xfa\xef]\xad\xca\xc0\xfb\x80\xf9\x0c\xce&\xaa\x90\xe6\xe9+\xafg\x18"
    ),
    bytearray(
        b"\xb5\xb5\xea\x8c\x1f\xd7\xef\x9c\x08\xf6M\xecl\x08[/\x84o\xd8J\xa8\x8a\n\xff{t\x95\xd5\xcf\xb2\xfa\xc8g\xba\xef\x16\x8b\xdf\x92\xfb\xc5\xb3\x10\xc9r\xfe\x8f\xfc\xef{\xfa`P"
    ),
    bytearray(
        b"\xad\xb4\xa2\x8c5\x98\xf2\x97\x1d\xa4\x02\xeevIB`\x93e\xd4M\xf5\xcfs\xe36-\x8b\xde\xc4\xfe\xf5\x8b\\\xb0\xac\x11\xce\xdf\xdd\xe1\x96\xf9\n\xcfr\xf2\xdf\xf0\xed+\x9fxQ"
    ),
    bytearray(
        b"\xb8\xaf\xb4\xc2v\x93\xe8\x8e\x07\xa4\x19\xf3aIMn\x8es\x8d\t\xb5\x98D\xac5-\xbd\xd5\xcc\xb2\xb9\x8d@\xf5\xbb\x12\x8b\x8b\xd7\xed\x84\xadE\xd0s\xad\x8b\xa9\xe9n\xbfd\x18"
    ),
    bytearray(
        b"\xad\xb4\xa2\x8c!\x92\xa7\x96\x1c\xf0\x19\xfa$\x01J}\x98 \x82M\x83\x80\x06\xacme\x9d\xcf\x88\xfa\xb4\x98D\xb0\xa1\x1f\x8a\x8b\xc1\xe7\xc5\xa9\x00\xdbe\xbb\xc0\xa9\xad+\x8aqY"
    ),
]


def xor_key(entry: bytes, key: bytes) -> tuple[float, bytes]:
    decoded_bytes = bytes(a ^ key for a in entry)
    return (frequency_kl_scoring(decoded_bytes), decoded_bytes)


def frequency_kl_scoring(decoded):
    """
    KL divergence, aka relative entropy:
    D_kl(p(x) || q(x)) = sum_for_all_x = p(x)ln(p(x)/q(x)) where p and q are probability distributions
    score of 0 means no entropy - same distribution
    """
    from collections import Counter
    import math

    for byte in decoded:
        if byte not in range(123):
            return 100

    letter_count = Counter(str(decoded).lower())
    message_len = len(decoded)
    mess_freq = {
        ch: int(letter_count[ch] / message_len * 1000) / 1000 for ch in letter_count
    }
    KL_div_score = 0
    for ch in hp_freq:
        if ch in letter_count:
            KL_div_score += hp_freq[ch] * math.log(hp_freq[ch] / mess_freq[ch])
        else:
            KL_div_score += hp_freq[ch] * math.log(hp_freq[ch] / (10**-10))

    print("\n", mess_freq, KL_div_score)
    return KL_div_score  # lower score is better


ex = [x[0] for x in ct]
print(ex)

best_score, best_bytes = 100, None
for i in range(0, 255):
    score, decoded_bytes = xor_key(ex, i)
    if score < best_score:
        best_score = score
        best_bytes = decoded_bytes
print(best_bytes)
print(best_score)
